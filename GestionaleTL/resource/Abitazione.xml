<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  
 <mapper namespace="it.exolab.gestionaleTL.mapper.CondominioMapper">
  
  
  <select id="find" parameterType="Integer" resultMap="condominiomap">
		select
		c.id AS condominio_id, c.indirizzo AS condominio_indirizzo,
		a.id AS abitazione_id, a.interno AS abitazione_interno,
		v.id AS votazione_id, v.voto AS votazione_voto,
		u.id AS user_id, u.cf AS user_cf, u.nome AS user_nome, u.cognome AS user_cognome,
		u.email AS user_email, u.password AS user_password, u.telefono AS user_telefono,
		u.data_in AS user_data_in, u.data_out AS user_data_out,
		r.id AS ruolo_id, r.ruolo AS ruolo_ruolo 
		FROM condominio AS c
		inner join abitazione AS a on c.id = a.id_condominio
		inner join votazione AS v on a.id = v.id_abitazione
		inner join db_gestionale_tl.`user` AS u on a.id = u.id_abitazione
		inner join ruolo AS r on u.id_ruolo = r.id
		WHERE c.id = ${id};
	</select>
	
	<resultMap id="condominiomap" type="it.exolab.gestionaleTL.model.Condominio">
		<result property="id" column="condominio_id" />
		<result property="indirizzo" column="condominio_indirizzo" />
		
	 <collection property="abitazione" javaType="it.exolab.gestionaleTL.model.Abitazione">
	  
	    <result property="id" column="abitazione_id"/>
	    <result property="interno" column="abitazione_interno"/>
	    
	  
	  
	  <association property="votazione" javaType="it.exolab.gestionaleTL.model.Votazione">
	  
	    <result property="id" column="votazione_id"/>
	    <result property="voto" column="votazione_voto"/>
	    
	  </association>
	  
	   <association property="user" javaType="it.exolab.gestionaleTL.model.User">
	  
	    <result property="id" column="user_id"/>
	    <result property="cf" column="user_cf"/>
	    <result property="nome" column="user_nome"/>
	    <result property="cognome" column="user_cognome"/>
	    <result property="email" column="user_email"/>
	    <result property="password" column="user_password"/>
	    <result property="telefono" column="user_telefono"/>
	    <result property="interno" column="votazione_voto"/>
	    <result property="data_in" column="user_data_in"/>
	    <result property="data_out" column="data_out"/>
	    
	  </association>
	  
	  <association property="ruolo" javaType="it.exolab.gestionaleTL.model.Ruolo">
	  
	    <result property="id" column="ruolo_id"/>
	    <result property="ruolo" column="ruolo_ruolo"/>
	    
	  </association>
	 
	 </collection>
	</resultMap>
</mapper>